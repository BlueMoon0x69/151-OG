<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Collection Pok√©mon 151 ‚Äî Guide d'installation</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&family=Space+Mono:wght@400;700&display=swap');

  :root {
    --yellow: #FFD93D;
    --blue: #1a56db;
    --blue-dark: #0f3399;
    --red: #ff4757;
    --green: #2ed573;
    --bg: #f0f4ff;
    --white: #ffffff;
    --text: #1e2a4a;
    --gray: #6b7a99;
    --card-shadow: 0 4px 20px rgba(26,86,219,0.12);
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: 'Nunito', sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
  }

  /* HEADER */
  header {
    background: linear-gradient(135deg, var(--blue-dark) 0%, var(--blue) 60%, #3b82f6 100%);
    padding: 48px 40px 40px;
    position: relative;
    overflow: hidden;
  }

  header::before {
    content: '';
    position: absolute;
    top: -60px; right: -60px;
    width: 280px; height: 280px;
    background: rgba(255,217,61,0.15);
    border-radius: 50%;
  }

  header::after {
    content: '';
    position: absolute;
    bottom: -80px; left: -40px;
    width: 200px; height: 200px;
    background: rgba(255,255,255,0.06);
    border-radius: 50%;
  }

  header h1 {
    font-size: 2em;
    font-weight: 900;
    color: var(--white);
    position: relative;
    z-index: 1;
    display: flex;
    align-items: center;
    gap: 14px;
    flex-wrap: wrap;
  }

  header h1 .badge {
    background: var(--yellow);
    color: var(--blue-dark);
    font-size: 0.45em;
    padding: 4px 12px;
    border-radius: 20px;
    font-weight: 800;
    letter-spacing: 0.5px;
    vertical-align: middle;
  }

  header p {
    color: rgba(255,255,255,0.75);
    margin-top: 10px;
    font-size: 1em;
    position: relative;
    z-index: 1;
  }

  /* MAIN */
  main {
    max-width: 820px;
    margin: 0 auto;
    padding: 40px 24px 60px;
  }

  /* STEP */
  .step {
    background: var(--white);
    border-radius: 16px;
    padding: 28px 32px;
    margin-bottom: 24px;
    box-shadow: var(--card-shadow);
    border-left: 5px solid var(--blue);
    position: relative;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }

  .step:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 30px rgba(26,86,219,0.18);
  }

  .step-header {
    display: flex;
    align-items: center;
    gap: 14px;
    margin-bottom: 18px;
  }

  .step-num {
    background: var(--blue);
    color: white;
    width: 36px; height: 36px;
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    font-weight: 900;
    font-size: 1em;
    flex-shrink: 0;
  }

  .step h2 {
    font-size: 1.15em;
    font-weight: 800;
    color: var(--text);
  }

  /* COLORS PER STEP */
  .step:nth-child(1) { border-color: #3b82f6; }
  .step:nth-child(1) .step-num { background: #3b82f6; }
  .step:nth-child(2) { border-color: #10b981; }
  .step:nth-child(2) .step-num { background: #10b981; }
  .step:nth-child(3) { border-color: #f59e0b; }
  .step:nth-child(3) .step-num { background: #f59e0b; }
  .step:nth-child(4) { border-color: #8b5cf6; }
  .step:nth-child(4) .step-num { background: #8b5cf6; }
  .step:nth-child(5) { border-color: #ef4444; }
  .step:nth-child(5) .step-num { background: #ef4444; }
  .step:nth-child(6) { border-color: #06b6d4; }
  .step:nth-child(6) .step-num { background: #06b6d4; }

  /* TABLE */
  .col-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.88em;
    margin: 12px 0;
  }

  .col-table th {
    background: #e8eeff;
    color: var(--blue-dark);
    padding: 8px 12px;
    text-align: center;
    font-weight: 800;
    font-size: 0.85em;
    letter-spacing: 0.3px;
  }

  .col-table td {
    padding: 7px 12px;
    text-align: center;
    border-bottom: 1px solid #eef0f8;
    font-weight: 600;
    color: var(--gray);
  }

  .col-table tr:last-child td { border-bottom: none; }

  /* ORDERED LIST */
  ol {
    padding-left: 20px;
    margin: 8px 0;
  }
  ol li {
    padding: 5px 0;
    line-height: 1.6;
    font-size: 0.95em;
  }

  /* CODE */
  pre {
    background: #1e2a4a;
    color: #e2e8f8;
    border-radius: 10px;
    padding: 18px 20px;
    font-family: 'Space Mono', monospace;
    font-size: 0.78em;
    overflow-x: auto;
    margin: 14px 0;
    line-height: 1.7;
  }

  code {
    font-family: 'Space Mono', monospace;
    background: #e8eeff;
    color: var(--blue-dark);
    padding: 2px 7px;
    border-radius: 5px;
    font-size: 0.85em;
  }

  pre code {
    background: none;
    color: inherit;
    padding: 0;
    font-size: inherit;
  }

  .comment { color: #6b7a99; }
  .key { color: #FFD93D; }
  .val { color: #7ee787; }
  .str { color: #ff9f43; }

  /* ALERT BOX */
  .alert {
    border-radius: 10px;
    padding: 12px 16px;
    font-size: 0.9em;
    margin: 12px 0;
    font-weight: 600;
    display: flex;
    gap: 10px;
    align-items: flex-start;
  }

  .alert-yellow {
    background: #fffbeb;
    border: 1.5px solid #fbbf24;
    color: #92400e;
  }

  .alert-green {
    background: #f0fdf4;
    border: 1.5px solid #34d399;
    color: #065f46;
  }

  /* USAGE */
  .usage-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    margin: 12px 0;
  }

  .usage-card {
    background: #f8faff;
    border-radius: 10px;
    padding: 14px 16px;
    border: 1.5px solid #dde3f8;
  }

  .usage-card .title {
    font-weight: 800;
    font-size: 0.88em;
    color: var(--blue);
    margin-bottom: 6px;
  }

  .usage-card p {
    font-size: 0.85em;
    color: var(--gray);
    line-height: 1.5;
  }

  /* TROUBLE TABLE */
  .trouble-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.9em;
    margin-top: 10px;
  }

  .trouble-table th {
    background: #fef3c7;
    color: #92400e;
    padding: 9px 14px;
    text-align: left;
    font-weight: 800;
  }

  .trouble-table td {
    padding: 10px 14px;
    border-bottom: 1px solid #eef0f8;
    line-height: 1.5;
  }

  .trouble-table td:first-child {
    font-weight: 700;
    color: var(--red);
    width: 40%;
  }

  .trouble-table tr:last-child td { border-bottom: none; }

  /* FOOTER */
  footer {
    text-align: center;
    padding: 30px;
    color: var(--gray);
    font-size: 0.85em;
  }

  footer span { color: var(--red); }
</style>
</head>
<body>

<header>
  <h1>üé¥ Collection Pok√©mon 151 <span class="badge">GUIDE D'INSTALLATION</span></h1>
  <p>Suis ces 6 √©tapes pour connecter ton site √† Google Sheets en ~15 minutes</p>
</header>

<main>

  <!-- √âTAPE 1 -->
  <div class="step">
    <div class="step-header">
      <div class="step-num">1</div>
      <h2>Cr√©er le Google Sheet</h2>
    </div>
    <ol>
      <li>Ouvre <strong>Google Sheets</strong> et cr√©e une nouvelle feuille</li>
      <li>Nomme-la <code>Collection Pok√©mon</code></li>
      <li>Cr√©e ces colonnes en ligne 1 :</li>
    </ol>
    <table class="col-table">
      <tr>
        <th>A</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th><th>G</th><th>H</th>
      </tr>
      <tr>
        <td>Nom</td><td>Num√©ro</td><td>S√©rie</td><td>Prix</td><td>Raret√©</td><td>URL Cardmarket</td><td>URL Image</td><td>Poss√©d√©e</td>
      </tr>
    </table>
    <ol start="4">
      <li>Importe ton fichier <code>collection_pokemon.csv</code> via <strong>Fichier ‚Üí Importer</strong></li>
    </ol>
  </div>

  <!-- √âTAPE 2 -->
  <div class="step">
    <div class="step-header">
      <div class="step-num">2</div>
      <h2>Rendre le Sheet public</h2>
    </div>
    <ol>
      <li>Clique sur <strong>Partager</strong> (haut droite)</li>
      <li>Passe l'acc√®s √† <strong>"Tous les utilisateurs disposant du lien"</strong> en mode <strong>Lecteur</strong></li>
    </ol>
    <div class="alert alert-yellow">
      ‚ö†Ô∏è Le Sheet doit √™tre public en lecture seule, jamais en mode √âditeur.
    </div>
  </div>

  <!-- √âTAPE 3 -->
  <div class="step">
    <div class="step-header">
      <div class="step-num">3</div>
      <h2>Activer l'API Google Sheets</h2>
    </div>
    <ol>
      <li>Va sur <strong>Google Cloud Console</strong> et cr√©e un projet</li>
      <li><strong>API et services ‚Üí Biblioth√®que</strong> ‚Üí recherche <code>Google Sheets API</code> ‚Üí Activer</li>
      <li><strong>Identifiants ‚Üí Cr√©er une cl√© API</strong> ‚Üí copie-la</li>
      <li>Restreins la cl√© √† Google Sheets API uniquement (s√©curit√©)</li>
    </ol>
  </div>

  <!-- √âTAPE 4 -->
  <div class="step">
    <div class="step-header">
      <div class="step-num">4</div>
      <h2>Cr√©er le Google Apps Script</h2>
    </div>
    <ol>
      <li>Dans ton Sheet : <strong>Extensions ‚Üí Apps Script</strong></li>
      <li>Remplace tout le code par celui ci-dessous et <strong>Enregistre</strong></li>
      <li><strong>D√©ployer ‚Üí Nouveau d√©ploiement ‚Üí Application Web</strong><br>
        ‚Üí Ex√©cuter en tant que : <code>Moi</code> | Qui a acc√®s : <code>Tout le monde</code></li>
      <li>Clique sur <strong>D√©ployer</strong> et <strong>copie l'URL</strong> g√©n√©r√©e</li>
    </ol>
    <pre><code><span class="comment">// API de synchronisation cartes Pok√©mon</span>

<span class="key">function</span> <span class="str">doGet</span>(e) {
  <span class="key">const</span> sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  <span class="key">const</span> data = sheet.getDataRange().getValues();
  <span class="key">const</span> headers = data[0];
  <span class="key">const</span> cards = data.slice(1).map(row => {
    <span class="key">const</span> card = {};
    headers.forEach((h, i) => card[h] = row[i] || <span class="val">''</span>);
    <span class="key">return</span> card;
  });
  <span class="key">return</span> ContentService
    .createTextOutput(JSON.stringify({ success: <span class="val">true</span>, cards }))
    .setMimeType(ContentService.MimeType.JSON);
}

<span class="key">function</span> <span class="str">doPost</span>(e) {
  <span class="key">try</span> {
    <span class="key">const</span> sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
    <span class="key">const</span> params = JSON.parse(e.postData.contents);
    <span class="key">if</span> (params.action === <span class="val">'toggle'</span>) {
      sheet.getRange(params.rowIndex + 2, 8).setValue(params.isOwned ? <span class="val">'OUI'</span> : <span class="val">'NON'</span>);
      <span class="key">return</span> ContentService
        .createTextOutput(JSON.stringify({ success: <span class="val">true</span> }))
        .setMimeType(ContentService.MimeType.JSON);
    }
  } <span class="key">catch</span> (error) {
    <span class="key">return</span> ContentService
      .createTextOutput(JSON.stringify({ success: <span class="val">false</span>, error: error.toString() }))
      .setMimeType(ContentService.MimeType.JSON);
  }
}</code></pre>
  </div>

  <!-- √âTAPE 5 -->
  <div class="step">
    <div class="step-header">
      <div class="step-num">5</div>
      <h2>Configurer le site</h2>
    </div>
    <p style="font-size:0.95em; margin-bottom:12px;">Ouvre <code>config.js</code> et remplis les valeurs :</p>
    <pre><code><span class="key">const</span> CONFIG = {
  SHEET_ID: <span class="val">'VOTRE_SHEET_ID'</span>,    <span class="comment">// Dans l'URL du Google Sheet</span>
  API_KEY:  <span class="val">'VOTRE_API_KEY'</span>,     <span class="comment">// Cr√©√©e √† l'√©tape 3</span>
  SHEET_NAME: <span class="val">'Feuille 1'</span>,
  APPS_SCRIPT_URL: <span class="val">'VOTRE_URL'</span>  <span class="comment">// Copi√©e √† l'√©tape 4</span>
};</code></pre>
    <div class="alert alert-green">
      üí° L'ID du Sheet se trouve dans son URL : <code>docs.google.com/spreadsheets/d/<strong>[SHEET_ID]</strong>/edit</code>
    </div>
  </div>

  <!-- √âTAPE 6 -->
  <div class="step">
    <div class="step-header">
      <div class="step-num">6</div>
      <h2>Mettre en ligne sur Netlify</h2>
    </div>
    <p style="font-size:0.95em; margin-bottom:10px;">Uploade ces fichiers sur Netlify :</p>
    <ol>
      <li><code>index.html</code></li>
      <li><code>config.js</code></li>
      <li>Dossier <code>css/</code></li>
    </ol>
  </div>

  <!-- UTILISATION -->
  <div class="step" style="border-color: #10b981;">
    <div class="step-header">
      <div class="step-num" style="background:#10b981;">üéÆ</div>
      <h2>Utilisation quotidienne</h2>
    </div>
    <div class="usage-grid">
      <div class="usage-card">
        <div class="title">‚ûï Ajouter une carte</div>
        <p>Ouvre le Sheet, ajoute une ligne. Le site se met √† jour automatiquement toutes les 5 min.</p>
      </div>
      <div class="usage-card">
        <div class="title">‚úÖ Cocher une carte</div>
        <p>Coche directement sur le site. La colonne H du Sheet se synchronise en temps r√©el.</p>
      </div>
      <div class="usage-card">
        <div class="title">‚úèÔ∏è Modifier une carte</div>
        <p>Modifie le prix, la raret√©, etc. dans le Sheet et clique sur üîÑ Actualiser.</p>
      </div>
      <div class="usage-card">
        <div class="title">üóëÔ∏è Supprimer une carte</div>
        <p>Supprime la ligne dans le Sheet et actualise le site.</p>
      </div>
    </div>
  </div>

  <!-- D√âPANNAGE -->
  <div class="step" style="border-color: #f59e0b;">
    <div class="step-header">
      <div class="step-num" style="background:#f59e0b;">üÜò</div>
      <h2>D√©pannage</h2>
    </div>
    <table class="trouble-table">
      <tr>
        <th>Probl√®me</th>
        <th>Solution</th>
      </tr>
      <tr>
        <td>Impossible de charger</td>
        <td>V√©rifier que le Sheet est public et que la cl√© API est correcte</td>
      </tr>
      <tr>
        <td>Les modifs n'apparaissent pas</td>
        <td>Cliquer sur üîÑ Actualiser ou vider le cache (Ctrl+F5)</td>
      </tr>
      <tr>
        <td>Une carte ne s'affiche pas</td>
        <td>V√©rifier que l'URL de l'image est valide et que la ligne est compl√®te</td>
      </tr>
    </table>
  </div>

</main>

<footer>
  R√©alis√© avec <span>‚ù§Ô∏è</span> pour la Collection Pok√©mon 151
</footer>

</body>
</html>
